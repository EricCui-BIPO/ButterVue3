# Prompt 编写规范准则

## 目录
- [1. 基础原则](#1-基础原则)
- [2. 结构规范](#2-结构规范)
- [3. AI特别约束](#3-ai特别约束)
- [4. 上下文管理](#4-上下文管理)
- [5. 多轮对话设计](#5-多轮对话设计)
- [6. 错误恢复机制](#6-错误恢复机制)
- [7. 性能优化](#7-性能优化)
- [8. 实用工具与方法](#8-实用工具与方法)
- [9. 高级场景应用](#9-高级场景应用)
- [10. 量化评估体系](#10-量化评估体系)
- [11. 实施指导](#11-实施指导)
- [12. 维护机制](#12-维护机制)
- [13. 最佳实践](#13-最佳实践)

---

## 1. 基础原则

### 核心要求
**必须**使用简洁明确的条列式表达
**必须**采用强约束词（必须/禁止/只允许）
**禁止**包含冗余解释和模糊描述
**禁止**使用主观性表述（如"建议"、"最好"）
**必须**每个要求都是可验证的

### 表达规范
**必须**使用主动语态，避免被动语态
**必须**使用肯定句式，避免否定句式
**必须**使用专业术语，避免口语化表达
**必须**保持一致性，避免术语混用

### 约束力度
**必须**分级使用约束词：
- "必须"：强制要求，不可违反
- "禁止"：绝对禁止，不可逾越
- "只允许"：限定范围，不可超出
- "应该"：推荐做法，但可灵活处理

---

## 2. 结构规范

### 标准结构
```
## [章节标题]

### 子章节标题
**职责**：[AI的角色定位说明]
**规范**：[具体操作要求清单]
**示例**：[标准示范案例]
**检查清单**：[AI需要检查的项目]
```

### 职责定义
**必须**明确说明AI的角色定位
**必须**包含具体的业务领域范围
**必须**明确AI的权限边界
**禁止**使用模糊的角色描述

### 规范要求
**必须**使用条列式列出具体操作要求
**必须**每个要求都是独立的、可执行的
**必须**包含输入和输出的明确规范
**必须**指定使用的工具和方法

### 示例说明
**必须**提供完整的标准示范案例
**必须**包含输入示例和期望输出
**必须**解释关键步骤的执行逻辑
**必须**覆盖常见的边界情况

### 检查清单
**必须**单独列出AI需要严格遵守的检查项目
**必须**每个检查项目都是可验证的
**必须**包含关键限制条件
**必须**按重要性排序

---

## 3. AI特别约束

### 通用约束
**必须**检查所有输入参数的有效性
**必须**验证输出结果的准确性
**必须**在异常情况下提供明确的错误处理
**禁止**生成不安全或有害的内容
**禁止**绕过任何安全限制

### 内容约束
**必须**确保内容符合法律法规要求
**必须**避免生成歧视性或偏见性内容
**必须**保护用户隐私和敏感信息
**禁止**生成可能引起误解的模糊内容
**禁止**复制受版权保护的内容

### 操作约束
**必须**使用指定的工具和方法
**必须**按照规定的流程执行
**必须**记录关键操作步骤
**禁止**使用未授权的工具或方法
**禁止**跳过必要的验证步骤

### 质量约束
**必须**确保输出内容的准确性
**必须**保持内容的一致性
**必须**遵循指定的格式要求
**禁止**生成低质量或无用的内容
**禁止**忽略重要的细节要求

---

## 4. 上下文管理

### 上下文设计原则
**必须**明确定义上下文的范围和边界
**必须**建立上下文的优先级机制
**必须**设计上下文的传递和继承规则
**禁止**在上下文中包含敏感信息
**禁止**创建过于复杂的上下文结构

### 上下文信息分类
**系统上下文**：
- 必须包含AI的角色定位
- 必须包含任务的基本要求
- 必须包含安全和合规约束
- 必须包含输出格式规范

**业务上下文**：
- 必须包含业务领域知识
- 必须包含相关的业务规则
- 必须包含数据模型定义
- 必须包含业务流程说明

**技术上下文**：
- 必须包含技术栈信息
- 必须包含架构约束
- 必须包含编码规范
- 必须包含工具和框架要求

### 上下文管理策略
**必须**使用分层的上下文管理
**必须**实现上下文的动态更新
**必须**提供上下文的版本控制
**必须**建立上下文的清理机制
**禁止**无限制地累积上下文信息

### 上下文优化技巧
**必须**压缩冗余的上下文信息
**必须**使用引用而非复制重复信息
**必须**建立上下文的索引机制
**必须**实现上下文的智能检索

---

## 5. 多轮对话设计

### 对话状态管理
**必须**维护对话的状态信息
**必须**跟踪对话的进度和阶段
**必须**记录关键的决策点
**必须**保持对话的连贯性
**禁止**丢失重要的对话历史

### 对话流程设计
**必须**设计清晰的对话流程图
**必须**定义每个阶段的输入输出
**必须**设置合理的分支条件
**必须**提供流程的回退机制
**禁止**创建死循环的对话流程

### 对话策略
**澄清策略**：
- 必须在信息不足时主动澄清
- 必须使用具体的问题而非泛泛询问
- 必须提供选项供用户选择
- 必须验证理解的准确性

**引导策略**：
- 必须引导用户提供必要信息
- 必须使用渐进式的信息收集
- 必须提供示例和模板
- 必须给出明确的下一步指导

**确认策略**：
- 必须在关键节点进行确认
- 必须总结已收集的信息
- 必须让用户验证理解的正确性
- 必须在执行前获得最终确认

### 对话质量保证
**必须**监控对话的质量指标
**必须**识别对话中的问题模式
**必须**提供对话的改进建议
**必须**建立对话的评估机制

---

## 6. 错误恢复机制

### 错误分类与识别
**输入错误**：
- 参数缺失或格式错误
- 数据类型不匹配
- 值超出有效范围
- 逻辑关系不一致

**处理错误**：
- 算法执行失败
- 资源访问异常
- 依赖服务不可用
- 超时或性能问题

**输出错误**：
- 格式不符合要求
- 内容不完整或错误
- 逻辑不一致
- 违反安全约束

### 错误处理策略
**预防策略**：
- 必须进行输入验证
- 必须设置合理的默认值
- 必须使用防御性编程
- 必须建立监控机制

**检测策略**：
- 必须实现实时错误检测
- 必须使用多层验证机制
- 必须建立异常监控
- 必须记录错误日志

**恢复策略**：
- 必须提供自动恢复机制
- 必须支持手动干预
- 必须保存恢复点
- 必须提供回滚功能

### 错误响应规范
**必须**提供清晰的错误描述
**必须**指出错误的具体位置
**必须**给出修复建议
**必须**提供替代方案
**禁止**暴露系统内部信息
**禁止**使用技术术语对用户说明

### 错误学习机制
**必须**收集和分析错误模式
**必须**更新错误处理规则
**必须**优化预防机制
**必须**分享错误处理经验

---

## 7. 性能优化

### 性能指标定义
**响应时间**：
- 平均响应时间 < 3秒
- 95%请求响应时间 < 5秒
- 99%请求响应时间 < 10秒
- 超时阈值设置为30秒

**吞吐量**：
- 每秒处理请求数 > 100
- 并发用户数支持 > 1000
- 峰值处理能力 > 500 QPS
- 资源利用率 < 80%

**准确性**：
- 输出准确率 > 95%
- 格式正确率 > 99%
- 逻辑一致性 > 98%
- 安全合规率 = 100%

### 优化策略
**输入优化**：
- 必须压缩输入数据大小
- 必须使用批处理机制
- 必须实现输入缓存
- 必须优化数据传输

**处理优化**：
- 必须使用高效算法
- 必须实现并行处理
- 必须优化内存使用
- 必须减少计算复杂度

**输出优化**：
- 必须使用流式输出
- 必须压缩输出数据
- 必须实现增量更新
- 必须优化渲染性能

### 性能监控
**必须**建立实时性能监控
**必须**设置性能告警机制
**必须**记录性能指标历史
**必须**分析性能瓶颈
**必须**定期进行性能测试

---

## 8. 实用工具与方法

### Prompt 构建工具
**模板生成器**：
- 支持多种场景的模板
- 提供参数化配置
- 支持模板的组合和继承
- 提供模板的验证功能

**验证工具**：
- 语法检查器
- 逻辑一致性验证
- 安全性扫描
- 性能评估工具

**测试框架**：
- 单元测试支持
- 集成测试工具
- 性能测试套件
- 回归测试自动化

### 开发辅助工具
**IDE插件**：
- 语法高亮支持
- 自动补全功能
- 错误检测和提示
- 重构和优化建议

**调试工具**：
- 执行跟踪器
- 变量监视器
- 断点调试支持
- 日志分析工具

**版本管理**：
- Git集成支持
- 变更历史跟踪
- 分支管理策略
- 合并冲突解决

### 质量保证工具
**代码审查**：
- 自动化审查规则
- 人工审查流程
- 质量评分机制
- 改进建议生成

**文档生成**：
- 自动文档生成
- API文档同步
- 示例代码提取
- 使用指南生成

---

## 9. 高级场景应用

### 复杂业务场景
**多系统集成**：
- 必须定义系统间的接口规范
- 必须处理数据格式转换
- 必须实现事务一致性
- 必须提供错误传播机制

**大规模数据处理**：
- 必须使用分布式处理架构
- 必须实现数据分片策略
- 必须提供容错机制
- 必须优化内存使用

**实时处理需求**：
- 必须使用流处理架构
- 必须实现低延迟优化
- 必须提供背压控制
- 必须保证数据一致性

### 特殊技术场景
**机器学习集成**：
- 必须定义模型接口规范
- 必须处理模型版本管理
- 必须实现A/B测试支持
- 必须提供模型监控

**区块链应用**：
- 必须遵循区块链协议
- 必须实现智能合约集成
- 必须处理共识机制
- 必须保证交易安全

**IoT设备集成**：
- 必须处理设备异构性
- 必须实现协议适配
- 必须提供设备管理
- 必须保证通信安全

### 行业特定场景
**金融服务**：
- 必须遵循金融监管要求
- 必须实现风险控制
- 必须保证交易安全
- 必须提供审计跟踪

**医疗健康**：
- 必须遵循医疗数据规范
- 必须保护患者隐私
- 必须实现数据脱敏
- 必须提供合规报告

**教育培训**：
- 必须支持个性化学习
- 必须实现学习路径规划
- 必须提供进度跟踪
- 必须保证内容质量

---

## 10. 量化评估体系

### 核心评估指标
**功能完整性评估**：
- 需求覆盖率：实现功能数 / 总需求数 × 100%
- 功能正确率：正确功能数 / 实现功能数 × 100%
- 边界处理率：处理边界案例数 / 总边界案例数 × 100%
- 异常处理率：处理异常情况数 / 总异常情况数 × 100%

**质量指标评估**：
- 代码质量分：基于静态分析工具评分（0-100分）
- 测试覆盖率：测试覆盖代码行数 / 总代码行数 × 100%
- 缺陷密度：缺陷数 / 千行代码（KLOC）
- 性能达标率：满足性能要求的功能数 / 总功能数 × 100%

**用户体验评估**：
- 易用性评分：用户满意度调查评分（1-10分）
- 学习成本：新用户掌握基本功能所需时间（小时）
- 错误恢复时间：从错误发生到恢复正常的平均时间（分钟）
- 帮助文档完整性：文档覆盖功能数 / 总功能数 × 100%

### 评估方法论
**定量评估**：
- 必须使用自动化测试工具
- 必须建立基准测试套件
- 必须进行性能基准测试
- 必须收集用户行为数据

**定性评估**：
- 必须进行专家评审
- 必须收集用户反馈
- 必须进行可用性测试
- 必须分析竞品对比

**持续评估**：
- 必须建立评估时间表
- 必须设置评估触发条件
- 必须跟踪评估趋势
- 必须制定改进计划

### 评估报告规范
**必须**包含评估摘要和结论
**必须**提供详细的数据分析
**必须**给出具体的改进建议
**必须**设置下次评估计划
**必须**包含风险评估和缓解措施

---

## 11. 实施指导

### 实施准备阶段
**团队准备**：
- 必须组建跨职能团队
- 必须明确角色和职责
- 必须提供必要的培训
- 必须建立沟通机制

**工具准备**：
- 必须选择合适的开发工具
- 必须配置开发环境
- 必须建立版本控制系统
- 必须设置持续集成流水线

**标准制定**：
- 必须制定编码规范
- 必须定义质量标准
- 必须建立审查流程
- 必须设置验收标准

### 实施执行阶段
**迭代开发**：
- 必须采用敏捷开发方法
- 必须进行短周期迭代
- 必须定期进行回顾
- 必须持续改进流程

**质量控制**：
- 必须进行代码审查
- 必须执行自动化测试
- 必须进行性能测试
- 必须验证安全性

**进度管理**：
- 必须跟踪项目进度
- 必须识别风险和问题
- 必须及时调整计划
- 必须保持透明沟通

### 实施验收阶段
**功能验收**：
- 必须验证所有功能需求
- 必须测试边界条件
- 必须验证异常处理
- 必须确认性能指标

**质量验收**：
- 必须检查代码质量
- 必须验证测试覆盖率
- 必须确认文档完整性
- 必须评估维护性

**部署准备**：
- 必须准备部署环境
- 必须制定部署计划
- 必须准备回滚方案
- 必须培训运维团队

### 实施成功因素
**必须**获得管理层支持
**必须**确保资源充足
**必须**建立激励机制
**必须**营造学习氛围
**必须**持续监控和改进

---

## 12. 维护机制

### 定期更新
**必须**定期审查和优化规范内容
**必须**根据技术发展更新要求
**必须**移除过时或无效的规定
**必须**补充新的最佳实践

### 反馈收集
**必须**建立用户反馈收集机制
**必须**记录实际应用中的问题
**必须**分析使用效果和满意度
**必须**统计违规情况和改进需求

### 版本控制
**必须**使用语义化版本号（SemVer）
**必须**记录每次更新的变更内容
**必须**保持向后兼容性
**必须**提供版本迁移指南

### 审核流程
**必须**建立规范的审核流程
**必须**邀请相关专家参与评审
**必须**确保新规范的合理性
**必须**测试新规范的实际效果

---

## 13. 最佳实践

### 场景模板

#### 代码生成场景
**职责**：AI作为代码生成助手，负责生成符合规范的代码
**规范**：
- 必须遵循项目的编码规范
- 必须生成可测试的代码
- 必须包含适当的注释
- 必须处理边界情况

**示例**：
```prompt
生成一个用户管理的Service类，要求：
1. 使用Spring Boot框架
2. 遵循DDD架构模式
3. 包含CRUD操作
4. 使用@Transactional注解
5. 包含异常处理
```

**检查清单**：
- [ ] 是否遵循了项目编码规范？
- [ ] 是否包含了完整的CRUD操作？
- [ ] 是否添加了适当的注释？
- [ ] 是否处理了异常情况？
- [ ] 是否可以直接运行和测试？

#### 文档编写场景
**职责**：AI作为文档编写助手，负责生成清晰的技术文档
**规范**：
- 必须使用Markdown格式
- 必须包含完整的目录结构
- 必须提供代码示例
- 必须说明使用场景

**示例**：
```prompt
编写API文档，要求：
1. 使用OpenAPI 3.0规范
2. 包含所有端点的详细说明
3. 提供请求和响应示例
4. 说明认证和授权要求
```

**检查清单**：
- [ ] 是否使用了正确的文档格式？
- [ ] 是否包含了完整的目录？
- [ ] 是否提供了足够的示例？
- [ ] 是否说明了使用场景？
- [ ] 是否易于理解和使用？

#### 测试生成场景
**职责**：AI作为测试生成助手，负责生成全面的测试用例
**规范**：
- 必须包含单元测试和集成测试
- 必须覆盖主要业务场景
- 必须测试异常情况
- 必须使用适当的断言

**示例**：
```prompt
生成测试用例，要求：
1. 使用JUnit 5框架
2. 测试正常业务流程
3. 测试异常情况
4. 使用Mockito模拟依赖
5. 验证边界条件
```

**检查清单**：
- [ ] 是否覆盖了所有主要功能？
- [ ] 是否测试了异常情况？
- [ ] 是否使用了正确的测试框架？
- [ ] 是否包含了适当的断言？
- [ ] 是否可以独立运行？

### 常见问题解决方案

#### 问题1：输入参数不完整
**识别标准**：
- 缺少必需的参数
- 参数格式不正确
- 参数值超出有效范围

**解决方案**：
- 必须验证所有必需参数
- 必须提供默认值或错误提示
- 必须使用参数验证注解
- 必须记录缺失的参数信息

**预防措施**：
- 建立参数验证模板
- 使用自动化验证工具
- 提供参数填写指南
- 建立参数检查清单

#### 问题2：输出格式不正确
**识别标准**：
- 输出结构不符合要求
- 数据类型错误
- 格式化不一致

**解决方案**：
- 必须验证输出格式
- 必须使用格式化工具
- 必须提供格式说明
- 必须支持多种输出格式

**预防措施**：
- 建立输出格式模板
- 使用自动化格式检查
- 提供格式示例
- 建立格式验证机制

#### 问题3：性能问题
**识别标准**：
- 响应时间超过预期
- 资源使用率过高
- 并发处理能力不足

**解决方案**：
- 必须优化算法复杂度
- 必须使用缓存机制
- 必须避免不必要的计算
- 必须监控性能指标

**预防措施**：
- 建立性能基准测试
- 使用性能监控工具
- 定期进行性能评估
- 建立性能优化指南

### 效果评估标准

#### 准确性评估
**评估维度**：
- 输出内容是否符合要求（目标：>95%）
- 是否包含所有必需的信息（目标：100%）
- 是否避免了错误的内容（目标：错误率<1%）
- 是否保持了逻辑一致性（目标：>98%）

**评估方法**：
- 使用自动化测试工具
- 进行人工抽样检查
- 建立评估基准数据集
- 定期进行准确性测试

#### 效率评估
**评估维度**：
- 响应时间是否在预期范围内（目标：<3秒）
- 资源使用是否合理（目标：CPU<70%，内存<80%）
- 是否避免了重复计算（目标：缓存命中率>80%）
- 是否优化了处理流程（目标：处理步骤<10步）

**评估方法**：
- 使用性能监控工具
- 进行压力测试
- 分析资源使用情况
- 建立性能基准

#### 易用性评估
**评估维度**：
- 输出是否易于理解（用户满意度>8分）
- 是否提供了足够的示例（示例覆盖率>90%）
- 是否支持不同的使用场景（场景覆盖率>85%）
- 是否具有良好的扩展性（扩展成本<20%）

**评估方法**：
- 进行用户满意度调查
- 收集用户反馈
- 进行可用性测试
- 分析使用模式

#### 维护性评估
**评估维度**：
- 代码结构是否清晰（复杂度评分>80分）
- 是否遵循了设计模式（模式符合率>90%）
- 是否便于后续修改（修改成本<30%）
- 是否具有可测试性（测试覆盖率>90%）

**评估方法**：
- 使用代码质量分析工具
- 进行代码审查
- 分析维护成本
- 评估测试覆盖率

### 持续改进机制

#### 改进流程
**识别改进点**：
- 收集用户反馈和建议
- 分析性能和质量指标
- 识别常见问题和痛点
- 研究最新技术和最佳实践

**制定改进计划**：
- 设定具体的改进目标
- 制定详细的实施计划
- 分配必要的资源
- 设置里程碑和检查点

**实施改进措施**：
- 按计划执行改进措施
- 监控改进效果
- 及时调整实施策略
- 记录改进过程和结果

**评估改进效果**：
- 对比改进前后的指标
- 收集用户对改进的反馈
- 分析改进的成本效益
- 总结改进经验和教训

#### 知识管理
**必须**建立知识库系统
**必须**记录最佳实践案例
**必须**分享成功经验
**必须**建立学习和培训机制
**必须**定期更新知识内容

---

## 附录

### 强约束词汇表
- **必须**：强制执行，不允许例外
- **禁止**：严格禁止，违反即错误
- **只允许**：限定范围，超出即违规
- **应该**：建议执行，可有例外情况
- **可以**：可选执行，根据情况决定

### 检查清单模板
```markdown
## Prompt 质量检查清单

### 基础要求检查
- [ ] 是否使用了强约束词？
- [ ] 是否提供了具体示例？
- [ ] 是否设置了验证机制？
- [ ] 是否明确了失败处理？
- [ ] 是否符合结构规范？

### 内容完整性检查
- [ ] 是否包含了所有必需信息？
- [ ] 是否定义了清晰的输入输出？
- [ ] 是否处理了边界情况？
- [ ] 是否包含了错误处理？
- [ ] 是否提供了使用示例？

### 质量标准检查
- [ ] 是否符合性能要求？
- [ ] 是否通过了安全检查？
- [ ] 是否满足可用性标准？
- [ ] 是否具备可维护性？
- [ ] 是否经过了充分测试？

### 用户体验检查
- [ ] 是否易于理解和使用？
- [ ] 是否提供了足够的帮助信息？
- [ ] 是否支持不同的使用场景？
- [ ] 是否有良好的错误提示？
- [ ] 是否提供了反馈机制？
```

### 实用工具清单

#### 开发工具
- **VSCode插件**：Prompt Snippets, AI Assistant
- **在线工具**：Prompt Tester, Format Validator
- **CLI工具**：prompt-cli, validation-tool
- **测试框架**：prompt-test, ai-test-suite

#### 质量保证工具
- **语法检查**：prompt-lint, syntax-checker
- **性能测试**：perf-test, load-tester
- **安全扫描**：security-scan, vulnerability-check
- **文档生成**：doc-gen, api-doc-tool

#### 监控和分析工具
- **性能监控**：performance-monitor, metrics-collector
- **用户分析**：user-analytics, feedback-analyzer
- **错误跟踪**：error-tracker, log-analyzer
- **趋势分析**：trend-analyzer, pattern-detector

### 版本历史
- v1.0.0 (2024-01-15): 初始版本，建立基础规范框架
- v1.1.0 (2024-02-20): 增加AI特别约束章节，完善错误处理机制
- v1.2.0 (2024-03-10): 增加场景模板和最佳实践，提供更多实用指导
- v2.0.0 (2024-12-XX): 重大更新，增加上下文管理、多轮对话设计、错误恢复机制、性能优化、实用工具、高级场景、量化评估体系和实施指导等章节，大幅提升内容完整性和可操作性

### 参考资源
- [OpenAI GPT最佳实践](https://platform.openai.com/docs/guides/gpt-best-practices)
- [Anthropic Claude使用指南](https://docs.anthropic.com/claude/docs)
- [Google AI Prompt工程指南](https://developers.google.com/machine-learning/guides/text-classification/step-2-5)
- [Microsoft AI安全最佳实践](https://docs.microsoft.com/en-us/azure/cognitive-services/responsible-use-of-ai-overview)
- [IEEE AI伦理标准](https://standards.ieee.org/standard/2857-2021.html)
- [ISO/IEC AI质量标准](https://www.iso.org/standard/77608.html)

### 社区资源
- **GitHub项目**：awesome-prompts, prompt-engineering
- **学术论文**：arXiv AI/ML section, ACL Anthology
- **技术博客**：Towards Data Science, AI Research Blog
- **在线课程**：Coursera AI Courses, edX Machine Learning

### 联系方式
如有问题或建议，请联系：
- 规范维护团队：prompt-standards@company.com
- 技术支持：tech-support@company.com
- 反馈渠道：feedback@company.com
- 社区论坛：https://community.company.com/prompt-standards

### 许可证
本文档采用 [Creative Commons Attribution-ShareAlike 4.0 International License](https://creativecommons.org/licenses/by-sa/4.0/) 许可证发布。

---

*最后更新时间：2024年12月*
*文档版本：v2.0.0*
*维护团队：AI开发规范委员会*